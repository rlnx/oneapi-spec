

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Specifying Priorities for Functional Nodes &mdash; oneAPI Specification 0.6.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicons.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="graph Class" href="graph_cls.html" />
    <link rel="prev" title="Lightweight policy" href="lightweight_policy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../library-interop.html">Library Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../elements.html">oneAPI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dpcpp/source/index.html">DPC++ (DPC++)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDPL/source/index.html">oneAPI DPC++ Library (oneDPL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDNN/source/index.html">oneAPI Deep Neural Network Library (oneDNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneCCL/source/index.html">oneAPI Collective Communications Library (oneCCL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../l0/source/index.html">oneAPI Level Zero (Level Zero)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDAL/source/index.html">oneAPI Data Analytics Library (oneDAL)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../nested-index.html">oneAPI Threading Building Blocks (oneTBB)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nested-gen-info.html">General Information</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nested-interfaces.html">oneTBB Interfaces</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms.html">Algorithms</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../flow_graph.html">Flow Graph</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="graph_cls.html">graph Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="abstract_interfaces.html">Abstract Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="special_message_types.html">Special Message Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="functional_nodes.html">Functional Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="buffering_nodes.html">Buffering Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="service_nodes.html">Service Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="ports_and_edges.html">Ports and Edges</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../task_scheduler.html">Task Scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../containers.html">Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thread_local_storage.html">Thread Local Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../nested-aux-interfaces.html">oneTBB Auxiliary Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneVPL/source/index.html">oneAPI Video Processing Library (oneVPL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneMKL/source/index.html">oneAPI Math Kernel Library (oneMKL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../nested-index.html">oneAPI Threading Building Blocks (oneTBB)</a> </li>
          
        
          
        
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneTBB/source/flow_graph/node_priorities.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="specifying-priorities-for-functional-nodes">
<h1>Specifying Priorities for Functional Nodes<a class="headerlink" href="#specifying-priorities-for-functional-nodes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The feature allows setting relative priorities at construction of flow graph functional
nodes, guiding threads that execute the graph to prefer nodes with higher priority.</p>
</div>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">tbb</span> <span class="p">{</span> <span class="k">namespace</span> <span class="n">flow</span> <span class="p">{</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">node_priority_t</span><span class="p">;</span>

<span class="k">const</span> <span class="n">node_priority_t</span> <span class="n">no_priority</span> <span class="o">=</span> <span class="n">node_priority_t</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="n">Output</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Policy</span> <span class="o">=</span> <span class="kt">void</span> <span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">continue_node</span> <span class="o">:</span> <span class="k">public</span> <span class="n">graph_node</span><span class="p">,</span> <span class="k">public</span> <span class="n">continue_receiver</span><span class="p">,</span> <span class="k">public</span> <span class="n">sender</span><span class="o">&lt;</span><span class="n">Output</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Body</span><span class="o">&gt;</span>
    <span class="n">continue_node</span><span class="p">(</span> <span class="n">graph</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">Body</span> <span class="n">body</span><span class="p">,</span> <span class="n">node_priority_t</span> <span class="o">=</span> <span class="n">no_priority</span> <span class="p">);</span>
    <span class="c1">// ...</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span> <span class="k">typename</span> <span class="n">Input</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Output</span> <span class="o">=</span> <span class="n">continue_msg</span><span class="p">,</span>
           <span class="k">typename</span> <span class="n">Policy</span> <span class="o">=</span> <span class="n">queueing</span><span class="p">,</span>
           <span class="k">typename</span> <span class="n">A</span> <span class="o">=</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">Input</span><span class="o">&gt;</span> <span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">function_node</span> <span class="o">:</span> <span class="k">public</span> <span class="n">graph_node</span><span class="p">,</span> <span class="k">public</span> <span class="n">receiver</span><span class="o">&lt;</span><span class="n">Input</span><span class="o">&gt;</span><span class="p">,</span> <span class="k">public</span> <span class="n">sender</span><span class="o">&lt;</span><span class="n">Output</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Body</span><span class="o">&gt;</span>
    <span class="n">function_node</span><span class="p">(</span> <span class="n">graph</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">concurrency</span><span class="p">,</span> <span class="n">Body</span> <span class="n">body</span><span class="p">,</span> <span class="n">node_priority_t</span> <span class="o">=</span> <span class="n">no_priority</span> <span class="p">);</span>
    <span class="c1">// ...</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span> <span class="k">typename</span> <span class="n">Input</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Output</span><span class="p">,</span>
           <span class="k">typename</span> <span class="n">Policy</span> <span class="o">=</span> <span class="n">queueing</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Allocator</span><span class="o">=</span><span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">Input</span><span class="o">&gt;</span> <span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">multifunction_node</span> <span class="o">:</span> <span class="k">public</span> <span class="n">graph_node</span><span class="p">,</span> <span class="k">public</span> <span class="n">receiver</span><span class="o">&lt;</span><span class="n">Input</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">template</span> <span class="o">&lt;</span> <span class="k">typename</span> <span class="n">Body</span> <span class="o">&gt;</span>
    <span class="n">multifunction_node</span><span class="p">(</span> <span class="n">graph</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">concurrency</span><span class="p">,</span> <span class="n">Body</span> <span class="n">body</span><span class="p">,</span> <span class="n">node_priority_t</span> <span class="o">=</span> <span class="n">no_priority</span> <span class="p">);</span>
    <span class="c1">// ...</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span> <span class="k">typename</span> <span class="n">Input</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Output</span><span class="p">,</span>
           <span class="k">typename</span> <span class="n">Policy</span> <span class="o">=</span> <span class="n">queueing_lightweight</span><span class="p">,</span>
           <span class="k">typename</span> <span class="n">Allocator</span> <span class="o">=</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">Input</span><span class="o">&gt;</span> <span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">async_node</span> <span class="o">:</span> <span class="k">public</span> <span class="n">graph_node</span><span class="p">,</span> <span class="k">public</span> <span class="n">receiver</span><span class="o">&lt;</span><span class="n">Input</span><span class="o">&gt;</span><span class="p">,</span> <span class="k">public</span> <span class="n">sender</span><span class="o">&lt;</span><span class="n">Output</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">Body</span><span class="o">&gt;</span>
    <span class="n">async_node</span><span class="p">(</span> <span class="n">graph</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">concurrency</span><span class="p">,</span> <span class="n">Body</span> <span class="n">body</span><span class="p">,</span> <span class="n">node_priority_t</span> <span class="o">=</span> <span class="n">no_priority</span> <span class="p">);</span>
    <span class="c1">// ...</span>
<span class="p">};</span>

<span class="p">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="header">
<h2>Header<a class="headerlink" href="#header" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#define TBB_PREVIEW_FLOW_GRAPH_FEATURES 1</span>
<span class="cp">#include</span> <span class="cpf">&quot;tbb/flow_graph.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The feature requires linkage with TBB preview binaries.</p>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>With this extension the <code class="docutils literal notranslate"><span class="pre">function_node</span></code>, the
<code class="docutils literal notranslate"><span class="pre">multifunction_node</span></code>, the <code class="docutils literal notranslate"><span class="pre">async_node</span></code> and the
<code class="docutils literal notranslate"><span class="pre">continue_node</span></code> accept additional contstructor parameter of
<code class="docutils literal notranslate"><span class="pre">node_priority_t</span></code> type, which sets the node priority in the graph: the larger
the specified value for the parameter, the higher the priority. The special constant value
<code class="docutils literal notranslate"><span class="pre">no_priority</span></code>, also the default value of the parameter, switches priority off
for a particular node.</p>
<p>For a particular graph, tasks to execute the nodes whose priority is specified have
precedence over tasks for the nodes with lower or no priority value set. When looking for a
task to execute, a thread will choose the one with the highest priority from those in the
graph which are available to be executed.</p>
<p>If a node with priority has nested parallel construct the thread that waits this parallel
contruct to complete might take tasks with no priority, but may not take another priority
task. If such behavior is undesirable, we recommend to either use isolation or specify a
priority for each node.</p>
<p>Execution of tasks spawned on behalf of the nodes with priority value set takes precedence
over execution of tasks whose priority is set through pre-existing priority specification
mechanism in the library.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The feature does not provide strong ordering guarantees. In particular, nodes whose policy
include <code class="docutils literal notranslate"><span class="pre">lightweight</span></code> can be executed without scheduling a task. Therefore,
priority of the task spawned on behalf of the node with priority value specified may be
ignored.</p>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The following basic example demostrates prioritization of one path in the graph over the
other, which may help to improve overall performance of the graph.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../../../../_images/critical_path_in_graph.png"><img alt="../../../../_images/critical_path_in_graph.png" src="../../../../_images/critical_path_in_graph.png" style="width: 463px; height: 336px;" /></a>
<p class="caption"><span class="caption-text">Data flow graph with critical path.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Consider executing the graph from the picture above using two threads. Let the nodes
<code class="docutils literal notranslate"><span class="pre">f1</span></code> and <code class="docutils literal notranslate"><span class="pre">f3</span></code> take equal time to
execute, while the node <code class="docutils literal notranslate"><span class="pre">f2</span></code> takes longer. That makes the nodes
<code class="docutils literal notranslate"><span class="pre">bs</span></code>, <code class="docutils literal notranslate"><span class="pre">f2</span></code> and
<code class="docutils literal notranslate"><span class="pre">fe</span></code> constitute the critical path in this graph. Due to the
non-deterministic behavior in selection of the tasks, TBB might execute nodes
<code class="docutils literal notranslate"><span class="pre">f1</span></code> and <code class="docutils literal notranslate"><span class="pre">f3</span></code> in parallel first, which
would make the whole graph execution time last longer than the case when one of the threads
chooses the node <code class="docutils literal notranslate"><span class="pre">f2</span></code> just after the broadcast node. By setting a
higher priority on node <code class="docutils literal notranslate"><span class="pre">f2</span></code>, threads are guided to take the
critical path task earlier, thus reducing overall execution time.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;cmath&gt;</span>

<span class="c1">#include &quot;tbb/task_scheduler_init.h&quot;</span>
<span class="c1">#include &quot;tbb/tick_count.h&quot;</span>

<span class="c1">#define TBB_PREVIEW_FLOW_GRAPH_FEATURES 1</span>
<span class="c1">#include &quot;tbb/flow_graph.h&quot;</span>

<span class="n">void</span> <span class="n">spin_for</span><span class="p">(</span> <span class="n">double</span> <span class="n">delta_seconds</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">tbb</span><span class="p">::</span><span class="n">tick_count</span> <span class="n">start</span> <span class="o">=</span> <span class="n">tbb</span><span class="p">::</span><span class="n">tick_count</span><span class="p">::</span><span class="n">now</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">tbb</span><span class="p">::</span><span class="n">tick_count</span><span class="p">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">delta_seconds</span> <span class="p">)</span> <span class="p">;</span>
<span class="p">}</span>

<span class="n">static</span> <span class="n">const</span> <span class="n">double</span> <span class="n">unit_of_time</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>

<span class="n">struct</span> <span class="n">Body</span> <span class="p">{</span>
    <span class="n">unsigned</span> <span class="n">factor</span><span class="p">;</span>
    <span class="n">Body</span><span class="p">(</span> <span class="n">unsigned</span> <span class="n">times</span> <span class="p">)</span> <span class="p">:</span> <span class="n">factor</span><span class="p">(</span> <span class="n">times</span> <span class="p">)</span> <span class="p">{}</span>
    <span class="n">void</span> <span class="n">operator</span><span class="p">()(</span> <span class="n">const</span> <span class="n">tbb</span><span class="p">::</span><span class="n">flow</span><span class="p">::</span><span class="n">continue_msg</span><span class="o">&amp;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">body</span> <span class="n">execution</span> <span class="n">takes</span> <span class="s1">&#39;factor&#39;</span> <span class="n">units</span> <span class="n">of</span> <span class="n">time</span>
        <span class="n">spin_for</span><span class="p">(</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">unit_of_time</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">using</span> <span class="n">namespace</span> <span class="n">tbb</span><span class="p">::</span><span class="n">flow</span><span class="p">;</span>

    <span class="n">const</span> <span class="nb">int</span> <span class="n">max_threads</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">tbb</span><span class="p">::</span><span class="n">task_scheduler_init</span> <span class="n">s</span><span class="p">(</span><span class="n">max_threads</span><span class="p">);</span>

    <span class="n">graph</span> <span class="n">g</span><span class="p">;</span>

    <span class="n">broadcast_node</span><span class="o">&lt;</span><span class="n">continue_msg</span><span class="o">&gt;</span> <span class="n">bs</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>

    <span class="n">continue_node</span><span class="o">&lt;</span><span class="n">continue_msg</span><span class="o">&gt;</span> <span class="n">f1</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Body</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>

    <span class="o">//</span> <span class="n">f2</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">heavy</span> <span class="n">one</span> <span class="ow">and</span> <span class="n">takes</span> <span class="n">the</span> <span class="n">most</span> <span class="n">execution</span> <span class="n">time</span> <span class="k">as</span> <span class="n">compared</span> <span class="n">to</span> <span class="n">the</span> <span class="n">other</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="n">the</span>
    <span class="o">//</span> <span class="n">graph</span><span class="o">.</span> <span class="n">Therefore</span><span class="p">,</span> <span class="n">let</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">start</span> <span class="n">this</span> <span class="n">node</span> <span class="k">as</span> <span class="n">soon</span> <span class="k">as</span> <span class="n">possible</span> <span class="n">by</span> <span class="n">prioritizing</span> <span class="n">it</span> <span class="n">over</span>
    <span class="o">//</span> <span class="n">the</span> <span class="n">other</span> <span class="n">nodes</span><span class="o">.</span>
    <span class="n">continue_node</span><span class="o">&lt;</span><span class="n">continue_msg</span><span class="o">&gt;</span> <span class="n">f2</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Body</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">node_priority_t</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>

    <span class="n">continue_node</span><span class="o">&lt;</span><span class="n">continue_msg</span><span class="o">&gt;</span> <span class="n">f3</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Body</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>

    <span class="n">continue_node</span><span class="o">&lt;</span><span class="n">continue_msg</span><span class="o">&gt;</span> <span class="n">fe</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Body</span><span class="p">(</span><span class="mi">7</span><span class="p">));</span>

    <span class="n">make_edge</span><span class="p">(</span> <span class="n">bs</span><span class="p">,</span> <span class="n">f1</span> <span class="p">);</span>
    <span class="n">make_edge</span><span class="p">(</span> <span class="n">bs</span><span class="p">,</span> <span class="n">f2</span> <span class="p">);</span>
    <span class="n">make_edge</span><span class="p">(</span> <span class="n">bs</span><span class="p">,</span> <span class="n">f3</span> <span class="p">);</span>

    <span class="n">make_edge</span><span class="p">(</span> <span class="n">f1</span><span class="p">,</span> <span class="n">fe</span> <span class="p">);</span>
    <span class="n">make_edge</span><span class="p">(</span> <span class="n">f2</span><span class="p">,</span> <span class="n">fe</span> <span class="p">);</span>
    <span class="n">make_edge</span><span class="p">(</span> <span class="n">f3</span><span class="p">,</span> <span class="n">fe</span> <span class="p">);</span>

    <span class="n">tbb</span><span class="p">::</span><span class="n">tick_count</span> <span class="n">start</span> <span class="o">=</span> <span class="n">tbb</span><span class="p">::</span><span class="n">tick_count</span><span class="p">::</span><span class="n">now</span><span class="p">();</span>

    <span class="n">bs</span><span class="o">.</span><span class="n">try_put</span><span class="p">(</span> <span class="n">continue_msg</span><span class="p">()</span> <span class="p">);</span>
    <span class="n">g</span><span class="o">.</span><span class="n">wait_for_all</span><span class="p">();</span>

    <span class="n">double</span> <span class="n">elapsed</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">floor</span><span class="p">((</span><span class="n">tbb</span><span class="p">::</span><span class="n">tick_count</span><span class="p">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">seconds</span><span class="p">()</span> <span class="o">/</span> <span class="n">unit_of_time</span><span class="p">);</span>

    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Elapsed approximately &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">elapsed</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; units of time&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Elapsed</span> <span class="n">approximately</span> <span class="mi">17</span> <span class="n">units</span> <span class="n">of</span> <span class="n">time</span>
</pre></div>
</div>
<p>If no value or the special constant <code class="docutils literal notranslate"><span class="pre">no_priority</span></code> is passed as an argument
then the output would be:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Elapsed</span> <span class="n">approximately</span> <span class="mi">22</span> <span class="n">units</span> <span class="n">of</span> <span class="n">time</span>
</pre></div>
</div>
<p>See also:</p>
<ul class="simple">
<li><p><a class="reference internal" href="lightweight_policy.html"><span class="doc">Lightweight policy</span></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="graph_cls.html" class="btn btn-neutral float-right" title="graph Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lightweight_policy.html" class="btn btn-neutral float-left" title="Lightweight policy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>