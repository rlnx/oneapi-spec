

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cache_aligned_allocator Template Class &mdash; oneAPI Specification 0.6.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicons.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="zero_allocator" href="zero_allocator.html" />
    <link rel="prev" title="scalable allocator Template Class" href="scalable_allocator_cls.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../library-interop.html">Library Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../elements.html">oneAPI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dpcpp/source/index.html">DPC++ (DPC++)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDPL/source/index.html">DPC++ Library (oneDPL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDNN/source/index.html">Deep Neural Network Library (oneDNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneCCL/source/index.html">Collective Communications Library (oneCCL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../l0/source/index.html">Level Zero (Level Zero)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDAL/source/index.html">Data Analytics Library (oneDAL)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../nested-index.html">Threading Building Blocks (oneTBB)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nested-gen-info.html">General Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nested-interfaces.html">oneTBB Interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nested-aux-interfaces.html">oneTBB Auxiliary Interfaces</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../memory_allocation.html">Memory Allocation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="c_interface_to_scalable_allocator.html">C Interface to Scalable Allocator</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="allocator_concept.html">Allocator Concept</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_resource_interface.html">Memory Resource Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="TBB_malloc_replacement_log_func.html">TBB_malloc_replacement_log Function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../synchronization.html">Synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../timing.html">Timing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneVPL/source/index.html">Video Processing Library (oneVPL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneMKL/source/index.html">Math Kernel Library (oneMKL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../nested-index.html">Threading Building Blocks (oneTBB)</a> </li>
          
        
          
        
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneTBB/source/memory_allocation/cache_aligned_allocator_cls.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cache-aligned-allocator-template-class">
<h1>cache_aligned_allocator Template Class<a class="headerlink" href="#cache-aligned-allocator-template-class" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Template class for allocating memory in a way that
avoids false sharing.</p>
</div>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">cache_aligned_allocator</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="header">
<h2>Header<a class="headerlink" href="#header" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;tbb/cache_aligned_allocator.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>A
<code class="docutils literal notranslate"><span class="pre">cache_aligned_allocator</span></code> allocates memory on cache line
boundaries, in order to avoid false sharing. False sharing is when logically
distinct items occupy the same cache line, which can hurt performance if
multiple threads attempt to access the different items simultaneously. Even
though the items are logically separate, the processor hardware may have to
transfer the cache line between the processors as if they were sharing a
location. The net result can be much more memory traffic than if the logically
distinct items were on different cache lines.</p>
<p>A
<code class="docutils literal notranslate"><span class="pre">cache_aligned_allocator</span></code> models the Allocator Concept.
It can be used to replace a
<code class="docutils literal notranslate"><span class="pre">std::allocator</span></code>. Used judiciously,
<code class="docutils literal notranslate"><span class="pre">cache_aligned_allocator</span></code> can improve performance by
reducing false sharing. However, it is sometimes an inappropriate replacement,
because the benefit of allocating on a cache line comes at the price that
<code class="docutils literal notranslate"><span class="pre">cache_aligned_allocator</span></code> implicitly adds pad memory.
The padding is typically 128 bytes. Hence allocating many small objects with
<code class="docutils literal notranslate"><span class="pre">cache_aligned_allocator</span></code> may increase memory usage.</p>
</div>
<div class="section" id="members">
<h2>Members<a class="headerlink" href="#members" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">tbb</span> <span class="p">{</span>

    <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
    <span class="k">class</span> <span class="nc">cache_aligned_allocator</span> <span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="k">typedef</span> <span class="n">T</span><span class="o">*</span> <span class="n">pointer</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="k">const</span> <span class="n">T</span><span class="o">*</span> <span class="n">const_pointer</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">reference</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">const_reference</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="n">T</span> <span class="n">value_type</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="kt">size_t</span> <span class="n">size_type</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="kt">ptrdiff_t</span> <span class="n">difference_type</span><span class="p">;</span>
        <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">U</span><span class="o">&gt;</span> <span class="k">struct</span> <span class="n">rebind</span> <span class="p">{</span>
            <span class="k">typedef</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="n">other</span><span class="p">;</span>
        <span class="p">};</span>

    <span class="cp">#if _WIN64</span>
        <span class="kt">char</span><span class="o">*</span> <span class="nf">_Charalloc</span><span class="p">(</span> <span class="n">size_type</span> <span class="n">size</span> <span class="p">);</span>
    <span class="cp">#endif </span><span class="cm">/* _WIN64 */</span><span class="cp"></span>

        <span class="n">cache_aligned_allocator</span><span class="p">()</span> <span class="k">throw</span><span class="p">();</span>
        <span class="n">cache_aligned_allocator</span><span class="p">(</span> <span class="k">const</span> <span class="n">cache_aligned_allocator</span><span class="o">&amp;</span> <span class="p">)</span> <span class="k">throw</span><span class="p">();</span>
        <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">U</span><span class="o">&gt;</span>
        <span class="n">cache_aligned_allocator</span><span class="p">(</span> <span class="k">const</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&amp;</span> <span class="p">)</span> <span class="k">throw</span><span class="p">();</span>
        <span class="o">~</span><span class="n">cache_aligned_allocator</span><span class="p">();</span>

        <span class="n">pointer</span> <span class="nf">address</span><span class="p">(</span><span class="n">reference</span> <span class="n">x</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
        <span class="n">const_pointer</span> <span class="nf">address</span><span class="p">(</span><span class="n">const_reference</span> <span class="n">x</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>

        <span class="n">pointer</span> <span class="nf">allocate</span><span class="p">(</span> <span class="n">size_type</span> <span class="n">n</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">hint</span><span class="o">=</span><span class="mi">0</span> <span class="p">);</span>
        <span class="kt">void</span> <span class="nf">deallocate</span><span class="p">(</span> <span class="n">pointer</span> <span class="n">p</span><span class="p">,</span> <span class="n">size_type</span> <span class="p">);</span>
        <span class="n">size_type</span> <span class="nf">max_size</span><span class="p">()</span> <span class="k">const</span> <span class="k">throw</span><span class="p">();</span>

        <span class="kt">void</span> <span class="nf">construct</span><span class="p">(</span> <span class="n">pointer</span> <span class="n">p</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">value</span> <span class="p">);</span>
        <span class="kt">void</span> <span class="nf">destroy</span><span class="p">(</span> <span class="n">pointer</span> <span class="n">p</span> <span class="p">);</span>
    <span class="p">};</span>

    <span class="k">template</span><span class="o">&lt;&gt;</span>
    <span class="k">class</span> <span class="nc">cache_aligned_allocator</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="k">typedef</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pointer</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">const_pointer</span><span class="p">;</span>
        <span class="k">typedef</span> <span class="kt">void</span> <span class="n">value_type</span><span class="p">;</span>
        <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">U</span><span class="o">&gt;</span> <span class="k">struct</span> <span class="n">rebind</span> <span class="p">{</span>
            <span class="k">typedef</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="n">other</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">};</span>

    <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="k">typename</span> <span class="n">U</span><span class="o">&gt;</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span> <span class="k">const</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="p">,</span>
                     <span class="k">const</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&amp;</span> <span class="p">);</span>

    <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="k">typename</span> <span class="n">U</span><span class="o">&gt;</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">!=</span><span class="p">(</span> <span class="k">const</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="p">,</span>
                     <span class="k">const</span> <span class="n">cache_aligned_allocator</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&amp;</span> <span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<p>For sake of brevity, the following table describes
only those methods that differ significantly from the corresponding methods of
<code class="docutils literal notranslate"><span class="pre">std::allocator</span></code>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 1%" />
<col style="width: 99%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p>Member, Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">pointer</span> <span class="pre">allocate(</span> <span class="pre">size_type</span> <span class="pre">n,</span> <span class="pre">const</span> <span class="pre">void*</span> <span class="pre">hint=0</span> <span class="pre">)</span></code></dt><dd><p>Allocates
<em>n</em> bytes of memory on a cache-line boundary. The
allocation may include extra hidden padding.</p>
<p><strong>Returns</strong>: Pointer to the allocated memory.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">deallocate(</span> <span class="pre">pointer</span> <span class="pre">p,</span> <span class="pre">size_type</span> <span class="pre">n</span> <span class="pre">)</span></code></dt><dd><p><strong>Requirements</strong>: Pointer
<code class="docutils literal notranslate"><span class="pre">p</span></code> must be the result of method
<code class="docutils literal notranslate"><span class="pre">allocate(n)</span></code>. The memory must not have been
already deallocated.</p>
<p><strong>Effects</strong>: Deallocates memory pointed to by
<code class="docutils literal notranslate"><span class="pre">p</span></code>. The deallocation also deallocates any
extra hidden padding.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">char*</span> <span class="pre">_Charalloc(</span> <span class="pre">size_type</span> <span class="pre">size</span> <span class="pre">)</span></code></dt><dd><dl>
<dt></dt><dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is provided only on 64-bit Windows* OS
platforms. It is a non-ISO method that exists for backwards compatibility with
versions of Window’s containers that seem to require it. Please do not use it
directly.</p>
</div>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="zero_allocator.html" class="btn btn-neutral float-right" title="zero_allocator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="scalable_allocator_cls.html" class="btn btn-neutral float-left" title="scalable allocator Template Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>