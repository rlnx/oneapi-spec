

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>blocked_rangeNd Template Class &mdash; oneAPI Specification 0.6.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../../_static/favicons.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Partitioners" href="../partitioners.html" />
    <link rel="prev" title="blocked_range3d Template Class" href="blocked_range3d_cls.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../library-interop.html">Library Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../elements.html">oneAPI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dpcpp/source/index.html">DPC++ (DPC++)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDPL/source/index.html">DPC++ Library (oneDPL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDNN/source/index.html">Deep Neural Network Library (oneDNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneCCL/source/index.html">Collective Communications Library (oneCCL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../l0/source/index.html">Level Zero (Level Zero)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDAL/source/index.html">Data Analytics Library (oneDAL)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../nested-index.html">Threading Building Blocks (oneTBB)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../nested-gen-info.html">General Information</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../nested-interfaces.html">oneTBB Interfaces</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../algorithms.html">Algorithms</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../splittable_concept.html">Splittable Concept</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../range_concept.html">Range Concept</a></li>
<li class="toctree-l4"><a class="reference internal" href="../partitioners.html">Partitioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_for_func.html">parallel_for Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_reduce_func.html">parallel_reduce Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_deterministic_reduce_func.html">parallel_deterministic_reduce Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_scan_func.html">parallel_scan Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_do_func.html">parallel_do Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_for_each_func.html">parallel_for_each Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_invoke_func.html">parallel_invoke Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../variadic_parallel_invoke_func.html">parallel_invoke Variadic Template Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_pipeline_func.html">parallel_pipeline Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../parallel_sort_func.html">parallel_sort Template Function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../flow_graph.html">Flow Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../task_scheduler.html">Task Scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../containers.html">Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../thread_local_storage.html">Thread Local Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../nested-aux-interfaces.html">oneTBB Auxiliary Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneVPL/source/index.html">Video Processing Library (oneVPL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneMKL/source/index.html">Math Kernel Library (oneMKL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../../nested-index.html">Threading Building Blocks (oneTBB)</a> </li>
          
        
          
        
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneTBB/source/algorithms/range_concept/blocked_rangeNd_cls.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="blocked-rangend-template-class">
<h1>blocked_rangeNd Template Class<a class="headerlink" href="#blocked-rangend-template-class" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Template class that represents recursively divisible N-dimensional half-open interval.
The use of <code class="docutils literal notranslate"><span class="pre">blocked_rangeNd</span></code> requires C++11 support.</p>
</div>
<div class="section" id="header">
<h2>Header<a class="headerlink" href="#header" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#define TBB_PREVIEW_BLOCKED_RANGE_ND 1</span>
<span class="cp">#include</span> <span class="cpf">&quot;tbb/blocked_rangeNd.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Value</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">blocked_rangeNd</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">blocked_rangeNd&lt;Value,</span> <span class="pre">N&gt;</span></code> is the N-dimensional extension of the
<code class="docutils literal notranslate"><span class="pre">blocked_range</span></code>. Each dimension of the range is represented by a
<code class="docutils literal notranslate"><span class="pre">blocked_range&lt;Value&gt;</span></code>. The <code class="docutils literal notranslate"><span class="pre">Value</span></code> must meet
the requirements of the <em>Value Concept</em> described in the corresponding
table of the <em>blocked_range Template Class</em> section.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">blocked_rangeNd</span></code> models the Range Concept.
A <code class="docutils literal notranslate"><span class="pre">blocked_rangeNd</span></code> is divisible if either its axis is divisible, and
is empty if either its axis is empty. It supports proportional splitting.</p>
</div>
<div class="section" id="members">
<h2>Members<a class="headerlink" href="#members" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">tbb</span> <span class="p">{</span>

    <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Value</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span>
    <span class="k">class</span> <span class="nc">blocked_rangeNd</span> <span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="c1">// Types</span>
        <span class="k">using</span> <span class="n">value_type</span> <span class="o">=</span> <span class="n">Value</span><span class="p">;</span>

        <span class="c1">// Constructor</span>
        <span class="n">blocked_rangeNd</span><span class="p">(</span><span class="k">const</span> <span class="n">blocked_range</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">&gt;&amp;</span> <span class="n">dim0</span><span class="p">,</span> <span class="p">...,</span> <span class="k">const</span> <span class="n">blocked_range</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">&gt;&amp;</span> <span class="n">dimN</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

        <span class="c1">// Splitting constructors</span>
        <span class="n">blocked_rangeNd</span><span class="p">(</span><span class="n">blocked_rangeNd</span><span class="o">&amp;</span> <span class="n">r</span><span class="p">,</span> <span class="n">split</span> <span class="n">proportion</span><span class="p">);</span>
        <span class="n">blocked_rangeNd</span><span class="p">(</span><span class="n">blocked_rangeNd</span><span class="o">&amp;</span> <span class="n">r</span><span class="p">,</span> <span class="n">proportional_split</span> <span class="n">proportion</span><span class="p">);</span>

        <span class="c1">// Proportional split is enabled</span>
        <span class="k">static</span> <span class="k">const</span> <span class="kt">bool</span> <span class="n">is_splittable_in_proportion</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>

        <span class="c1">// Capacity</span>
        <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">ndims</span><span class="p">();</span>
        <span class="kt">bool</span> <span class="nf">empty</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

        <span class="c1">// Access</span>
        <span class="k">const</span> <span class="n">tbb</span><span class="o">::</span><span class="n">blocked_range</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">&gt;&amp;</span> <span class="n">dim</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="nf">is_divisible</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
    <span class="p">};</span>

<span class="p">}</span>
</pre></div>
</div>
<p>The following table provides additional information on the
members of this template class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 1%" />
<col style="width: 99%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p>Member, Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="2"><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">value_type</span></code></dt><dd><p>The type of a <code class="docutils literal notranslate"><span class="pre">Value</span></code> in any of N dimensions constituting a range.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">blocked_rangeNd&lt;Value,</span> <span class="pre">N&gt;(const</span> <span class="pre">blocked_range&lt;Value&gt;&amp;</span> <span class="pre">dim0,</span> <span class="pre">...,</span> <span class="pre">const</span> <span class="pre">blocked_range&lt;Value&gt;&amp;</span> <span class="pre">dim_Nminus1)</span></code></dt><dd><p>Constructor accepts exactly N <code class="docutils literal notranslate"><span class="pre">blocked_range&lt;value_type&gt;</span></code>
objects representing each dimension.</p>
<p><strong>Effects:</strong> Constructs a <code class="docutils literal notranslate"><span class="pre">blocked_rangeNd</span></code> as a Cartesian
product of N half-open one-dimensional intervals:</p>
<p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">dim0.begin(),</span> <span class="pre">dim0.end()</span> <span class="pre">)</span> <span class="pre">x</span> <span class="pre">...</span> <span class="pre">x</span> <span class="pre">[</span> <span class="pre">dim_Nminus1.begin(),</span> <span class="pre">dim_Nminus1.end()</span> <span class="pre">)</span></code></p>
<p>with the given grain sizes.</p>
<p><strong>Example:</strong> Statements</p>
<p><code class="docutils literal notranslate"><span class="pre">blocked_rangeNd&lt;std::size_t,</span> <span class="pre">2&gt;</span> <span class="pre">r({1,</span> <span class="pre">17},</span> <span class="pre">{3,</span> <span class="pre">284,</span> <span class="pre">5});</span></code></p>
<p>and</p>
<p><code class="docutils literal notranslate"><span class="pre">blocked_rangeNd&lt;std::size_t,</span> <span class="pre">2&gt;</span> <span class="pre">r(blocked_range&lt;std::size_t&gt;{1,</span> <span class="pre">17},</span> <span class="pre">blocked_range&lt;std::size_t&gt;{3,</span> <span class="pre">284,</span> <span class="pre">5});</span></code></p>
<p>construct two equal two-dimensional spaces. Each of them contains all value pairs of
the form <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code>, where <code class="docutils literal notranslate"><span class="pre">i</span></code> ranges from 1 to 16
with a grain size of 1, and <code class="docutils literal notranslate"><span class="pre">j</span></code> ranges from 3 to 283
with a grain size of 5.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">blocked_rangeNd&lt;Value,</span> <span class="pre">N&gt;(blocked_rangeNd&amp;</span> <span class="pre">r,</span> <span class="pre">split</span> <span class="pre">proportion)</span></code></dt><dd><p>Basic splitting constructor.</p>
<p><strong>Requirements</strong>:
<code class="docutils literal notranslate"><span class="pre">is_divisible()</span></code> is true.</p>
<p><strong>Effects</strong>: Partitions <code class="docutils literal notranslate"><span class="pre">r</span></code> into two subranges across one
of the dimensions. The axis to split is chosen for maximal ratio of its range size
to the respective grain size. In that dimension, the newly constructed blocked_range
is approximately the second half of the original range, and the range is updated to
be the remainder. Other dimensions and the grain sizes for each subrange remain the
same as in the original range.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">blocked_rangeNd&lt;Value,</span> <span class="pre">N&gt;(blocked_rangeNd&amp;</span> <span class="pre">r,</span> <span class="pre">proportional_split</span> <span class="pre">proportion)</span></code></dt><dd><p>Proportional splitting constructor.</p>
<p><strong>Requirements</strong>:
<code class="docutils literal notranslate"><span class="pre">is_divisible()</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p><strong>Effects</strong>: Partitions <code class="docutils literal notranslate"><span class="pre">r</span></code> into two subranges in the given
proportion across one of the dimensions. Except for proportional splitting of the
chosen axis, the behavior and effects are the same as those of the
basic splitting constructor.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td colspan="2"><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">const</span> <span class="pre">bool</span> <span class="pre">is_splittable_in_proportion</span></code></dt><dd><p>Denotes the ability of <code class="docutils literal notranslate"><span class="pre">blocked_rangeNd</span></code> instances to be
split proportionally. Set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">constexpr</span> <span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">ndims()</span></code></dt><dd><p><strong>Returns</strong>: the dimensionality of the range, which is <code class="docutils literal notranslate"><span class="pre">N</span></code>.
The method can be used in constant expressions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">empty()</span> <span class="pre">const</span></code></dt><dd><p><strong>Effects</strong>: Determines if range is empty.</p>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">true</span></code> if at least one dimension is empty,
otherwise <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">blocked_range&lt;Value&gt;&amp;</span> <span class="pre">dim(unsigned</span> <span class="pre">int</span> <span class="pre">k)</span> <span class="pre">const</span></code></dt><dd><p><strong>Requirements</strong>:
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">k</span> <span class="pre">&lt;</span> <span class="pre">N</span></code></p>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">blocked_range</span></code> for the <code class="docutils literal notranslate"><span class="pre">k</span></code>-th
dimension. The dimensions are numbered in the order of constructor arguments,
starting from 0.</p>
<p><strong>Example:</strong> For the range <code class="docutils literal notranslate"><span class="pre">r</span></code>, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">blocked_rangeNd&lt;std::size_t,</span> <span class="pre">2&gt;</span> <span class="pre">r({1,</span> <span class="pre">17},</span> <span class="pre">{3,</span> <span class="pre">284,</span> <span class="pre">5});</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">r.dim(0)</span></code> returns
<code class="docutils literal notranslate"><span class="pre">blocked_range&lt;std::size_t&gt;(1,</span> <span class="pre">17)</span></code> and
<code class="docutils literal notranslate"><span class="pre">r.dim(1)</span></code> returns
<code class="docutils literal notranslate"><span class="pre">blocked_range&lt;std::size_t&gt;(3,</span> <span class="pre">284,</span> <span class="pre">5)</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td colspan="2"><dl>
<dt><code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">is_divisible()</span> <span class="pre">const</span></code></dt><dd><p><strong>Effects</strong>: Determines if range can be split into subranges.</p>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">true</span></code> if at least one dimension is divisible,
otherwise false.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The example demonstrates calculation of a 3-dimensional filter over the pack of
feature maps applying 3-dimensional kernel to subrange of features.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">convolution3d</span></code> function iterates over the output cells and sets
cell values to the result of the <code class="docutils literal notranslate"><span class="pre">kernel3d</span></code> function. For the iteration
to be performed in parallel, <code class="docutils literal notranslate"><span class="pre">tbb::parallel_for</span></code> is called with a
<code class="docutils literal notranslate"><span class="pre">tbb::blocked_rangeNd&lt;int,</span> <span class="pre">3&gt;</span></code> as an argument.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">kernel3d</span></code> function summarizes the values from feature maps
in the scope of a 3-dimensional kernel.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#define TBB_PREVIEW_BLOCKED_RANGE_ND 1</span>
<span class="c1">#include &quot;tbb/blocked_rangeNd.h&quot;</span>

<span class="c1">#include &quot;tbb/parallel_for.h&quot;</span>
<span class="c1">#include &quot;tbb/parallel_reduce.h&quot;</span>

<span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">Features</span><span class="o">&gt;</span>
<span class="nb">float</span> <span class="n">kernel3d</span><span class="p">(</span><span class="n">const</span> <span class="n">Features</span><span class="o">&amp;</span> <span class="n">feature_maps</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span>
               <span class="nb">int</span> <span class="n">kernel_length</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kernel_width</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kernel_height</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">float</span> <span class="n">result</span> <span class="o">=</span> <span class="mf">0.</span><span class="n">f</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">feature_i</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">feature_i</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="n">kernel_length</span><span class="p">;</span> <span class="o">++</span><span class="n">feature_i</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">feature_j</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="n">feature_j</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">+</span> <span class="n">kernel_width</span><span class="p">;</span> <span class="o">++</span><span class="n">feature_j</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">feature_k</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span> <span class="n">feature_k</span> <span class="o">&lt;</span> <span class="n">k</span> <span class="o">+</span> <span class="n">kernel_width</span><span class="p">;</span> <span class="o">++</span><span class="n">feature_k</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="n">feature_maps</span><span class="p">[</span><span class="n">feature_i</span><span class="p">][</span><span class="n">feature_j</span><span class="p">][</span><span class="n">feature_k</span><span class="p">];</span>

    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">Features</span><span class="p">,</span> <span class="n">typename</span> <span class="n">Output</span><span class="o">&gt;</span>
<span class="n">void</span> <span class="n">convolution3d</span><span class="p">(</span><span class="n">const</span> <span class="n">Features</span><span class="o">&amp;</span> <span class="n">feature_maps</span><span class="p">,</span> <span class="n">Output</span><span class="o">&amp;</span> <span class="n">out</span><span class="p">,</span>
                   <span class="nb">int</span> <span class="n">out_length</span><span class="p">,</span> <span class="nb">int</span> <span class="n">out_width</span><span class="p">,</span> <span class="nb">int</span> <span class="n">out_heigth</span><span class="p">,</span>
                   <span class="nb">int</span> <span class="n">kernel_length</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kernel_width</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kernel_height</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">using</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">tbb</span><span class="p">::</span><span class="n">blocked_rangeNd</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="mi">3</span><span class="o">&gt;</span><span class="p">;</span>

    <span class="n">tbb</span><span class="p">::</span><span class="n">parallel_for</span><span class="p">(</span>
        <span class="n">range_t</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span> <span class="n">out_length</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="n">out_width</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="n">out_heigth</span><span class="p">}),</span>
        <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">const</span> <span class="n">range_t</span><span class="o">&amp;</span> <span class="n">out_range</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">auto</span> <span class="n">out_x</span> <span class="o">=</span> <span class="n">out_range</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">auto</span> <span class="n">out_y</span> <span class="o">=</span> <span class="n">out_range</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">auto</span> <span class="n">out_z</span> <span class="o">=</span> <span class="n">out_range</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

            <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">out_x</span><span class="o">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">out_x</span><span class="o">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">out_y</span><span class="o">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">out_y</span><span class="o">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
                    <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">out_z</span><span class="o">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">out_z</span><span class="o">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
                        <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kernel3d</span><span class="p">(</span><span class="n">feature_maps</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span>
                                                <span class="n">kernel_length</span><span class="p">,</span> <span class="n">kernel_width</span><span class="p">,</span> <span class="n">kernel_height</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../partitioners.html" class="btn btn-neutral float-right" title="Partitioners" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="blocked_range3d_cls.html" class="btn btn-neutral float-left" title="blocked_range3d Template Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>